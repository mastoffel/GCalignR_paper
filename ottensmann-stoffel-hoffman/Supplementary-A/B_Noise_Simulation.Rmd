---
title: "Simulate the effects of Noise"
author: "Meinolf Ottensmann, Martin A. Stoffel, Joseph Hoffman"
output: html_document
---

```{r, echo = FALSE}
library(knitr)
knitr::opts_chunk$set(collapse = TRUE, comment = "#>",cache = TRUE,
    fig.width = 7, fig.height = 7) # warning = FALSE
```

## Preamble
Here, we provide all necessary code for our simulation experiment that was conducted to estimate the effects of noise on the alignment of known substances. Due to the extensive computation time we include the aligned datasets along with this document.

## Rational
Based on the original datasets on bumblebee species published by [@Dellicour.2013] we simulated different noise levels by adding small deviations to randomly selected peaks within each sample. Thereby we use the unaffected data as a baseline to evaluate the robustness in peak alignments with GCalignR.

## Prerequisites
At first we need to align the datasets using the default setting. These will be our baseline estimations.
```{r}
library(GCalignR)
source("R/ChromaSimFunctions.R")
bbim_zero <- align_chromatograms(data = "data/bbim.txt",conc_col_name = "Area",rt_col_name = "RT")
beph_zero <- align_chromatograms(data = "data/beph.txt",conc_col_name = "Area",rt_col_name = "RT")
bfla_zero <- align_chromatograms(data = "data/bfla.txt",conc_col_name = "Area",rt_col_name = "RT")
```

## Build gc_peak_lists
```{r}
bbim_chroma <- bbim_zero[["aligned_list"]]
```